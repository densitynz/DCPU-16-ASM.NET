; Fibonacci Subroutine
; Input: A
; Output: The Ath fibonacci number in register A
:fibo
    SET PUSH, Y         ; Push our working variables to the stack.
    SET PUSH, Z
 
    IFB A, 0xfffe       ; The base case - if A = 1 or 0, return A.
    SET PC, reccase     ; Otherwise, return fibo(A-1) + fibo(A-2)
    SET PC, endfibo
 
:reccase                ; The recursive case.
    SUB A, 1
    SET Z, A
    JSR fibo            ; Calculate fibo(A-1)
    SET Y, A            ; Save it in Y
    SET A, Z
    SUB A, 1
    JSR fibo            ; Calculate fibo(A-2)